<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StudX - Homepage with Sponsored Products</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="sponsored-products.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f8fafc;
        }

        .hero-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 4rem 0;
            margin-bottom: 3rem;
        }

        .section-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 2rem;
            color: #1e293b;
        }

        .category-section {
            margin-bottom: 3rem;
        }

        .navbar-brand {
            font-weight: 700;
            font-size: 1.5rem;
        }

        .product-grid {
            margin-bottom: 3rem;
        }

        .regular-product-card {
            background: white;
            border-radius: 0.5rem;
            border: 1px solid #e2e8f0;
            transition: all 0.2s ease;
            height: 100%;
        }

        .regular-product-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .footer {
            background: #1e293b;
            color: white;
            padding: 3rem 0;
            margin-top: 4rem;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm">
        <div class="container">
            <a class="navbar-brand" href="#">
                <i class="fas fa-graduation-cap text-primary"></i>
                StudX
            </a>
            <div class="navbar-nav ms-auto">
                <a class="nav-link" href="#">Products</a>
                <a class="nav-link" href="#">Notes</a>
                <a class="nav-link" href="#">Rooms</a>
                <a class="nav-link" href="#">Login</a>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero-section">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-8">
                    <h1 class="display-4 mb-4">Your Student Marketplace</h1>
                    <p class="lead mb-4">Buy, sell, and exchange products, notes, and accommodations with fellow students.</p>
                    <a href="#" class="btn btn-light btn-lg">Get Started</a>
                </div>
            </div>
        </div>
    </section>

    <div class="container">
        <!-- Hero Banner Sponsored Product -->
        <section class="mb-5">
            <div id="heroBannerSponsored" 
                 data-sponsored-auto="true"
                 data-sponsored-type="banner"
                 data-sponsored-max="1"
                 data-sponsored-page="homepage">
            </div>
        </section>

        <!-- Featured Sponsored Products Grid -->
        <section class="category-section">
            <div id="featuredSponsored" 
                 data-sponsored-auto="true"
                 data-sponsored-type="grid"
                 data-sponsored-max="4"
                 data-sponsored-page="homepage">
            </div>
        </section>

        <!-- Regular Products with Inline Sponsored -->
        <section class="category-section">
            <h2 class="section-title">Latest Products</h2>
            <div class="row product-grid" id="regularProducts">
                <!-- Regular products will be loaded here -->
                <!-- Sponsored products will be mixed in -->
            </div>
        </section>

        <!-- Category-Specific Sponsored Products -->
        <section class="category-section">
            <h2 class="section-title">Textbooks & Study Materials</h2>
            <div id="textbooksSponsored" 
                 data-sponsored-auto="true"
                 data-sponsored-type="carousel"
                 data-sponsored-max="6"
                 data-sponsored-category="textbook"
                 data-sponsored-page="homepage">
            </div>
        </section>

        <!-- Electronics Category -->
        <section class="category-section">
            <h2 class="section-title">Electronics & Gadgets</h2>
            <div id="electronicsSponsored" 
                 data-sponsored-auto="true"
                 data-sponsored-type="grid"
                 data-sponsored-max="3"
                 data-sponsored-category="electronics"
                 data-sponsored-page="homepage">
            </div>
        </section>

        <!-- Accommodation Section -->
        <section class="category-section">
            <h2 class="section-title">Student Accommodation</h2>
            <div class="row">
                <div class="col-lg-8">
                    <!-- Regular room listings -->
                    <div class="row" id="regularRooms">
                        <!-- Regular rooms will be loaded here -->
                    </div>
                </div>
                <div class="col-lg-4">
                    <!-- Sponsored Rooms Sidebar -->
                    <div id="roomsSponsored" 
                         data-sponsored-auto="true"
                         data-sponsored-type="sidebar"
                         data-sponsored-max="4"
                         data-sponsored-category="accommodation"
                         data-sponsored-page="homepage">
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <h5>StudX</h5>
                    <p>Your trusted student marketplace for products, notes, and accommodations.</p>
                </div>
                <div class="col-md-6">
                    <h6>Quick Links</h6>
                    <ul class="list-unstyled">
                        <li><a href="#" class="text-light">About Us</a></li>
                        <li><a href="#" class="text-light">Contact</a></li>
                        <li><a href="#" class="text-light">Privacy Policy</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.7/dist/umd/supabase.min.js"></script>
    <script src="sponsored-products.js"></script>

    <script>
        // Initialize sponsored product manager
        const sponsoredManager = new SponsoredProductManager();

        // Load regular products and mix with sponsored
        async function loadRegularProducts() {
            try {
                // Simulate loading regular products
                const regularProducts = [
                    { id: 1, title: "Engineering Mathematics Book", price: 500, category: "textbook", image: "/api/placeholder/300/200" },
                    { id: 2, title: "Calculator TI-84", price: 2500, category: "electronics", image: "/api/placeholder/300/200" },
                    { id: 3, title: "Study Notes - Physics", price: 200, category: "notes", image: "/api/placeholder/300/200" },
                    { id: 4, title: "Laptop Stand", price: 800, category: "accessories", image: "/api/placeholder/300/200" },
                    { id: 5, title: "Programming Handbook", price: 600, category: "textbook", image: "/api/placeholder/300/200" },
                    { id: 6, title: "Wireless Mouse", price: 400, category: "electronics", image: "/api/placeholder/300/200" }
                ];

                const container = document.getElementById('regularProducts');
                let html = '';

                for (let i = 0; i < regularProducts.length; i++) {
                    const product = regularProducts[i];
                    
                    // Add regular product
                    html += `
                        <div class="col-md-4 col-sm-6 mb-4">
                            <div class="regular-product-card">
                                <img src="${product.image}" class="card-img-top" alt="${product.title}">
                                <div class="card-body">
                                    <h6 class="card-title">${product.title}</h6>
                                    <p class="text-success fw-bold">₹${product.price}</p>
                                    <span class="badge bg-secondary">${product.category}</span>
                                </div>
                            </div>
                        </div>
                    `;

                    // Insert sponsored product every 3rd position
                    if ((i + 1) % 3 === 0 && i < regularProducts.length - 1) {
                        html += `
                            <div class="col-md-4 col-sm-6 mb-4">
                                <div id="inlineSponsored${i}" class="h-100"></div>
                            </div>
                        `;
                    }
                }

                container.innerHTML = html;

                // Load sponsored products for inline positions
                for (let i = 2; i < regularProducts.length - 1; i += 3) {
                    const inlineContainer = document.getElementById(`inlineSponsored${i}`);
                    if (inlineContainer) {
                        // Create a single sponsored product display
                        await sponsoredManager.displaySponsored(`inlineSponsored${i}`, {
                            maxItems: 1,
                            displayType: 'grid',
                            currentPage: 'homepage',
                            responsiveColumns: { xs: 1, sm: 1, md: 1, lg: 1 }
                        });
                    }
                }

            } catch (error) {
                console.error('Error loading regular products:', error);
            }
        }

        // Load regular rooms
        async function loadRegularRooms() {
            const rooms = [
                { id: 1, title: "Single Room near Campus", price: 8000, location: "Near Main Gate" },
                { id: 2, title: "Shared Apartment", price: 5000, location: "Student Area" },
                { id: 3, title: "PG Accommodation", price: 6500, location: "College Road" }
            ];

            const container = document.getElementById('regularRooms');
            let html = '';

            rooms.forEach(room => {
                html += `
                    <div class="col-md-6 mb-3">
                        <div class="regular-product-card">
                            <div class="card-body">
                                <h6 class="card-title">${room.title}</h6>
                                <p class="text-success fw-bold">₹${room.price}/month</p>
                                <small class="text-muted">${room.location}</small>
                            </div>
                        </div>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        // Manual sponsored product examples
        function loadManualSponsoredExamples() {
            // Example: Load sponsored products for specific search context
            sponsoredManager.displaySponsored('searchSponsored', {
                maxItems: 2,
                displayType: 'sidebar',
                searchQuery: 'engineering books',
                currentPage: 'search'
            });

            // Example: Load category-specific sponsored products
            sponsoredManager.displaySponsored('categorySponsored', {
                maxItems: 4,
                displayType: 'grid',
                category: 'electronics',
                currentPage: 'category'
            });
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', () => {
            loadRegularProducts();
            loadRegularRooms();
            // loadManualSponsoredExamples(); // Uncomment for additional examples
        });

        // Analytics tracking example
        document.addEventListener('click', (e) => {
            if (e.target.closest('.sponsored-product-card')) {
                console.log('Sponsored product clicked!');
                // Additional tracking logic here
            }
        });
    </script>
</body>
</html>
